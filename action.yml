name: 'PR Changes Requested Labeler'
description: 'Automatically labels pull requests when any reviewer requests changes'

branding:
  icon: 'tag'
  color: 'orange'

runs:
  using: 'composite'
  steps:
    - name: Add label when changes requested
      if: github.event.review.state == 'changes_requested'
      uses: actions/github-script@v7
      with:
        script: |
          await github.rest.issues.addLabels({
            owner: context.repo.owner,
            repo: context.repo.repo,
            issue_number: context.payload.pull_request.number,
            labels: ['changes-requested']
          });

          console.log(`Label 'changes-requested' added to PR #${context.payload.pull_request.number}`);
